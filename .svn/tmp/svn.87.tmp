UPDATE FCOSTM
SET OSTMTOSTATES = '2,13,16,17'
WHERE OSTMRFNUM = 1;
UPDATE FCOSTM
SET OSTMTOSTATES = '3,4,7,10'
WHERE OSTMRFNUM = 2;
UPDATE FCOSTM
SET OSTMTOSTATES = '4'
WHERE OSTMRFNUM = 3;
UPDATE FCOSTM
SET OSTMTOSTATES = '6'
WHERE OSTMRFNUM = 4;
UPDATE FCOSTM
SET OSTMTOSTATES = '14'
WHERE OSTMRFNUM = 6;
UPDATE FCOSTM
SET OSTMTOSTATES = '9,13'
WHERE OSTMRFNUM = 8;
UPDATE FCOSTM
SET OSTMTOSTATES = '11,12,13'
WHERE OSTMRFNUM = 9;
UPDATE FCOSTM
SET OSTMTOSTATES = '3,4'
WHERE OSTMRFNUM = 10;
UPDATE FCOSTM
SET OSTMTOSTATES = '12'
WHERE OSTMRFNUM = 11;
UPDATE FCOSTM
SET OSTMTOSTATES = '6'
WHERE OSTMRFNUM = 14;
UPDATE FCOSTM
SET OSTMTOSTATES = '6'
WHERE OSTMRFNUM = 16;

ALTER TABLE `FCSDT`
  ADD COLUMN `SDTIMTRFNUM` BIGINT(20) NULL
  AFTER `SDTRFNUM`;

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `FCSDT`
  ADD INDEX `IXFK_FCSDT_FCIMT` (`SDTIMTRFNUM` ASC);

/* Create Foreign Key Constraints */

ALTER TABLE `FCSDT`
  ADD CONSTRAINT `FK_FCSDT_FCIMT`
FOREIGN KEY (`SDTIMTRFNUM`) REFERENCES `FCIMT` (`IMTRFNUM`)
  ON DELETE RESTRICT
  ON UPDATE RESTRICT;

/*Added by sumit on 15062017 to modify SIP tables*/
SET FOREIGN_KEY_CHECKS = 0;

/* Drop Tables */

DROP TABLE IF EXISTS `FCSIP` CASCADE;

/* Create Tables */

CREATE TABLE `FCSIP`
(
  `SIPRFNUM`             BIGINT      NOT NULL AUTO_INCREMENT,
  `SIPSTARTDATE`         DATE        NOT NULL,
  `SIPENDDATE`           DATE        NULL,
  `SIPINSTALLMENTAMOUNT` DOUBLE      NOT NULL,
  `SIPFREQUENCY`         CHAR(2)     NOT NULL
  COMMENT 'Weekly (w) Monthly (M) Quarterly (Q) Half-Yearly (H) Yearly (Y)',
  `SIPNOOFINSTALLMENTS`  INT         NOT NULL,
  `SIPSTATUS`            BIGINT      NOT NULL
  COMMENT 'Canceled Active',
  `SIPEXTERNALID`        VARCHAR(16) NULL,
  `SIPDEDUCTIONDAY`      INT         NULL,
  `SIPSOTRFNUM`          BIGINT      NULL,
  `SIPFOMTRFNUM`         BIGINT      NULL,
  `SIPTERMINATIONDATE`   DATE        NULL,
  `SIPREGISTRATIONDATE`  DATE        NOT NULL,
  `SIPRTAREGSLNO`        VARCHAR(64) NULL
  COMMENT 'RTA Registration Serial No.',
  `SIPRTATXNTYPE`        VARCHAR(16) NULL,
  `CREATEDATE`           TIMESTAMP   NULL     DEFAULT '2017-01-01 00:00:01',
  `MODIFYDATE`           TIMESTAMP   NOT NULL DEFAULT current_timestamp,
  `CREATEDBY`            CHAR(64)    NOT NULL,
  `LASTMODIFIEDBY`       CHAR(64)    NOT NULL,
  CONSTRAINT `PK_FCSIP` PRIMARY KEY (`SIPRFNUM` ASC)
)
  COMMENT = 'FCSIP: SIP Table';

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `FCSIP`
  ADD INDEX `IXFK_FCSIP_FCSPSM` (`SIPSTATUS` ASC);

/* Create Foreign Key Constraints */

ALTER TABLE `FCSIP`
  ADD CONSTRAINT `FK_FCSIP_FCFOMT`
FOREIGN KEY (`SIPFOMTRFNUM`) REFERENCES `FCFOMT` (`FOMTRFNUM`)
  ON DELETE RESTRICT
  ON UPDATE RESTRICT;

ALTER TABLE `FCSIP`
  ADD CONSTRAINT `FK_FCSIP_FCSOT`
FOREIGN KEY (`SIPSOTRFNUM`) REFERENCES `FCSOT` (`SOTRFNUM`)
  ON DELETE RESTRICT
  ON UPDATE RESTRICT;

ALTER TABLE `FCSIP`
  ADD CONSTRAINT `FK_FCSIP_FCSPSM`
FOREIGN KEY (`SIPSTATUS`) REFERENCES `FCSPSM` (`SPSMRFNUM`)
  ON DELETE RESTRICT
  ON UPDATE RESTRICT;

ALTER TABLE `FCSIP`
  ADD COLUMN `SIPSOPTRFNUM` BIGINT(20) NOT NULL
  AFTER `SIPFOMTRFNUM`,
  ADD INDEX `IXFK_FCSIP_FCSOPT` (`SIPSOPTRFNUM` ASC);
ALTER TABLE `FCSIP`
  ADD CONSTRAINT `FK_FCSIP_FCSOPT`
FOREIGN KEY (`SIPSOPTRFNUM`)
REFERENCES `FCSOPT` (`SOPTRFNUM`)
  ON DELETE RESTRICT
  ON UPDATE RESTRICT;


SET FOREIGN_KEY_CHECKS = 1;
INSERT INTO FCOSTM (OSTMRFNUM, OSTMNAME, OSTMACTIVE, OSTMDESCRIP, OSTMDISPLAYNAME, OSTMTOSTATES, CREATEDATE, MODIFYDATE, CREATEDBY, LASTMODIFIEDBY)
VALUES
  (17, 'ORDER_TO_BE_PLACED_LATER', 'Y', 'Order Created', 'Order Created', '2,13,16', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP,
   'SYSTEM', 'SYSTEM');

UPDATE FCACT
SET ACTCONSTANTVALUE = '09:30:00'
WHERE ACTRFNUM = 4;

/*Added by sumit on 19-06-2017 for KYC batch process*/

SET FOREIGN_KEY_CHECKS = 0;

/* Drop Tables */

DROP TABLE IF EXISTS `FCKCL` CASCADE;

/* Create Tables */

CREATE TABLE `FCKCL`
(
  `KCLRFNUM`        BIGINT      NOT NULL AUTO_INCREMENT,
  `KCLPANNO`        CHAR(10)    NOT NULL,
  `KCLAPI`          CHAR(10)    NULL,
  `KCLEXTERNALID1`  VARCHAR(16) NULL,
  `KCLEXTERNALID2`  VARCHAR(16) NULL,
  `KCLLASTRESPONSE` VARCHAR(32) NULL,
  `KCLREQUESTTIME`  TIMESTAMP   NULL,
  `CREATEDATE`      TIMESTAMP   NULL     DEFAULT '2017-01-01 00:00:01',
  `MODIFYDATE`      TIMESTAMP   NOT NULL DEFAULT current_timestamp,
  `CREATEDBY`       VARCHAR(64) NOT NULL,
  `LASTMODIFIEDBY`  VARCHAR(64) NOT NULL,
  CONSTRAINT `PK_FCKCL` PRIMARY KEY (`KCLRFNUM` ASC)
)
  COMMENT = 'FCKCL:  KYC Check Log';

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `FCKCL`
  ADD CONSTRAINT `UNQ_KCL_PANNO` UNIQUE (`KCLPANNO` ASC);

SET FOREIGN_KEY_CHECKS = 1;


/*Paresh - Added for removing PAN unique constraint*/
ALTER TABLE `FCUBD`
  DROP INDEX `UBD_PAN_UNIQUE`;

/*Added number of attempts logic*/
ALTER TABLE `FCKCL`
  ADD COLUMN `KCLNOOFATTEMPTS` INT NOT NULL
  AFTER `KCLREQUESTTIME`;

INSERT INTO FCACT (ACTRFNUM,ACTCONSTANTNAME, ACTCONSTANTVALUE, ACTACTIVE, CREATEDATE, MODIFYDATE, CREATEDBY, LASTMODIFIEDBY) VALUES (12,'PAYMENT_FALLBACK_BASE_URL', 'https://www.fincash.com/checkout/order/', 'Y', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 'admin', 'admin');

/*Added by sumit on 21-06-2017 for server user*/
INSERT INTO `FCACT` (`ACTRFNUM`, `ACTCONSTANTNAME`, `ACTCONSTANTVALUE`,`CREATEDATE`, `MODIFYDATE`, `ACTACTIVE`, `CREATEDBY`, `LASTMODIFIEDBY`) VALUES (13, 'SERVER_USER', 'server:fincash', 'Y',CURRENT_TIMESTAMP,CURRENT_TIMESTAMP, 'admin', 'admin');

/* Added for FCSIA foregin key changes */
ALTER TABLE `FCSIA`
DROP FOREIGN KEY `FK_FCSIA_FCSMT`;
ALTER TABLE `FCSIA`
ADD INDEX `FK_FCSIA_FCSMT_idx` (`SIASMTRFNUM` ASC),
ADD INDEX `FK_FCSIA_FCSOPT_idx` (`SIASOPTRFNUM` ASC),
ADD UNIQUE INDEX `UNQ_FCSIA_SMT_SOPT_IMT_TXN` (`SIASMTRFNUM` ASC, `SIASOPTRFNUM` ASC, `SIAIMTRFNUM` ASC, `SIATXNTYPE` ASC),
DROP INDEX `UNQ_SMT_IMT_TXNTYPE` ;
ALTER TABLE `FCSIA`
ADD CONSTRAINT `FK_FCSIA_FCSOPT`
  FOREIGN KEY (`SIASOPTRFNUM`)
  REFERENCES `FCSOPT` (`SOPTRFNUM`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
ADD CONSTRAINT `FK_FCSIA_FCSMT`
  FOREIGN KEY (`SIASMTRFNUM`)
  REFERENCES `FCSMT` (`SMTRFNUM`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

/* Addition to FCSIA */
INSERT INTO `FCSIA` (`SIARFNUM`, `SIASMTRFNUM`, `SIASOPTRFNUM`, `SIAIMTRFNUM`, `SIATXNTYPE`, `CREATEDBY`, `LASTMODIFIEDBY`) VALUES ('3', '1198', '106484', '3', 'R', 'admin', 'admin');
/*Added by sumit on 22-06-2017 for SIP tables modifications*/
ALTER TABLE `FCSIP`
  ADD COLUMN `SIPBSEREF` CHAR(16) NOT NULL AFTER `SIPRTATXNTYPE`,
  ADD COLUMN `SIPMMTLRFNUM` BIGINT(20) NOT NULL AFTER `SIPBSEREF`,
  ADD INDEX `FK_FCSIP_FCMMTL_idx` (`SIPMMTLRFNUM` ASC);
ALTER TABLE `FCSIP`
  ADD CONSTRAINT `FK_FCSIP_FCMMTL`
FOREIGN KEY (`SIPMMTLRFNUM`)
REFERENCES `FCMMTL` (`MMTLRFNUM`)
  ON DELETE RESTRICT
  ON UPDATE RESTRICT;
UPDATE FCACT SET ACTCONSTANTVALUE='[{\"heading\":\"HDFC Bank\",\"bankId\":54,\"subHeading\":\"(Transfer Funds via eCMS if transferring funds from HDFC Bank account)\",\"beneficiaryName\":\"Indian Clearing Corporation Limited\", \"accountNo\":\"MFDICC\",\"fullAccountNo\":\"MFDICC\",\"ifsc\":\"HDFC0000240\"},{\"heading\":\"ICICI Bank\",\"bankId\":58,\"subHeading\":\"(A/C No. 000405103922 if transferring funds from ICICI Bank account)\",\"beneficiaryName\":\"Indian Clearing Corporation Limited\", \"accountNo\":\"3922\",\"fullAccountNo\":\"000405103922\",\"ifsc\":\"ICIC0000104\"}]' WHERE ACTRFNUM=10;


ALTER TABLE `FCSST`
  DROP FOREIGN KEY `FK_FCSST_FCFHS`;
ALTER TABLE `FCSST`
  CHANGE COLUMN `SSTAMOUNT` `SSTAMOUNT` DOUBLE NULL ,
  CHANGE COLUMN `SSTDATE` `SSTDATE` DATE NULL ,
  CHANGE COLUMN `SSTCREDITDEBITFLAG` `SSTCREDITDEBITFLAG` VARCHAR(2) NULL ,
  CHANGE COLUMN `SSTFHSRFNUM` `SSTFHSRFNUM` BIGINT(20) NULL ,
  ADD COLUMN `SSTBSETRXNREF` CHAR(16) NOT NULL AFTER `SSTFHSRFNUM`,
  ADD COLUMN `SSTSTATUS` CHAR(10) NOT NULL AFTER `SSTBSETRXNREF`;
ALTER TABLE `FCSST`
  ADD CONSTRAINT `FK_FCSST_FCFHS`
FOREIGN KEY (`SSTFHSRFNUM`)
REFERENCES `FCFHS` (`FHSRFNUM`);